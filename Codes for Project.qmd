---
title: "The Way to Happiness: Higher Socioeconomic Status?"
author: "Tina Qian, Yanlin Li"
format: pdf
---

```{r read-data, echo = F, message = F}
library(tidyverse)
library(tidymodels)
library(readr)
library(tidyr)
library(ggplot2)
happiness <- read_csv("happiness.csv")

```
## Introduction: Motivation and Exploratory Data Analysis

  Happiness has long been one of people's most important aspires, and the relationship between socioeconomic status (SES) and happiness has become a focal point of multidisciplinary research on individual well-being and societal cohesion. Socioeconomic status, encompassing elements such as income, education, and occupation stands as a pivotal determinant in shaping the quality of life for individuals. Understanding the complexities of this relationship holds significant implications for policymakers, educators, and social scientists alike. While conventional wisdom suggests that higher SES often translates to greater happiness, we are curious to confirm this assumption with data-backed evidence.  

  We have come across the dataset labeled "happiness," provided by Wooldridge Data, which enables us to explore the correlation between various aspects of socioeconomic status and an individual's self-assessed happiness. ^[https://vincentarelbundock.github.io/Rdatasets/doc/wooldridge/happiness.html] This dataset, comprising 33 variables, contains demographic details of 17,137 individuals. Key variables include "happy" (indicating an individual's overall happiness), "workstat" (employment status), "income" (total family income), "educ" (highest level of education attained), "female" (1 if female), "babies" (household members under 6 years old), "preteens" (household members aged 6 to 12), and "teens" (household members aged 13 to 17).  

  Our research question in this instance is whether individuals with higher socioeconomic standing tend to report greater levels of happiness. Our hypothesis is a positive correlation; more specifically, an employed male with high household income, high educational level and fewer young members at home is anticipated to be happier.  

  Concerning our response variable "happy," we assigned numerical rankings of "1," "2," and "3" to its three categories—"not too happy," "pretty happy," and "very happy," respectively—to facilitate analysis and model fitting.  

  To create the predictor variable that records the number of household members under 17,  which was not originally included in our dataset, we aggregated data from three existing variables: the number of babies, preteens, and teenagers in the household. We believe it's more logical to consider these age groups collectively since each requires financial support and additional care from older members of the household, given that they are not yet fully independent.  

  Given the N/As across “educ”, “workstat”, “income” and the “young_members” variable in total is approximately ⅙ of all observations, using imputation to generate missing data might not be the optimal choice in this context. We thus filtered the NAs across each column and generated data visualization and regression on the existing data.   

  We generated visualizations to explore the relationships between the predictor variables and the response variable. Since most of our variables, including the response variable, are categorical, we opted for bar plots for all our exploratory data analyses.

```{r, echo = F}

happiness1 <- happiness |>
  mutate(young_members = babies + preteen + teens) |>
  select(educ, workstat, young_members, income, female, happy) |>
  mutate(Happy = case_when(
  happy == "not too happy" ~ 1,
  happy == "pretty happy" ~ 2,
  happy == "very happy" ~ 3,
  TRUE ~ NA_integer_))

happiness1 <- happiness1 |>
  mutate(income = factor(income, levels=c('lt $1000', '$1000 to 2999', '$3000 to 3999', '$4000 to 4999', '$5000 to 5999', '$6000 to 6999', '$7000 to 7999', '$8000 to 9999', '$10000 - 14999', '$15000 - 19999', '$20000 - 24999', '$25000 or more')))

delete.na <- function(happiness1, n = 0) {
  happiness1[rowSums(is.na(happiness1)) <= n, ]
}

Happiness <- delete.na(happiness1, n = 0)

ggplot(
  data = Happiness,
    aes(x = educ, width = 300, height = 300, fill = as.factor(Happy)))+
  geom_bar() +
  labs(x = "Highest Year of School Completed",
         y = "Number of Observations",
         title = "Distribution of participants' general happiness with
                  different highest year of school completed") +
  scale_fill_discrete(name = "Rated Happiness", labels = c("Not too happy", "Pretty happy", "Very happy"))

ggplot(
    data = Happiness,
    aes(x = Happy, width = 500, height = 500, fill = as.factor(Happy)))+
  geom_bar() +
  labs(y = "Number of Observations",
         x = "General Happiness",
         title = "Distribution of participants' general happiness for both genders") +
     facet_wrap(vars(female),labeller = labeller(female = c("1" = "Females", "0" = "Males"))) +
  scale_fill_discrete(name = "Rated Happiness", labels = c("Not too happy", "Pretty happy", "Very happy"))

ggplot(
  data = Happiness,
    aes(x = Happy, fill = as.factor(female)))+
  geom_bar() +
  labs(y = "Number of Observations",
         x = "General Happiness",
         title = "Distribution of participants' general happiness with 
     different work force status, adjusted for gender") +
     facet_wrap(vars(workstat)) +
  scale_fill_discrete(name = "Gender", labels = c("Male", "Female")) 


ggplot(
  data = Happiness,
  aes(x = Happy, fill = as.factor(Happy)))+
  geom_bar() +
  labs(y = "Number of Observations",
         x = "General Happiness",
         title = "Distribution of participants' general happiness 
     with different total family income") +
     facet_wrap(vars(income)) +
  scale_fill_discrete(name = "Rated Happiness", labels = c("Not too happy", "Pretty happy", "Very happy"))

ggplot(
    data = Happiness,
    aes(x = Happy, fill = as.factor(Happy)))+
  geom_bar() +
  labs(y = "Number of Observations",
         x = "General Happiness",
         title = "Distribution of participants' general happiness 
     with different number of household members under 17") +
     facet_wrap(vars(young_members)) +
  scale_fill_discrete(name = "Rated Happiness", labels = c("Not too happy", "Pretty happy", "Very happy"))


```

  The first bar plot examines the distribution of observations across different levels of highest year of school completed in the sample, accounting for their overall happiness. The majority of participants in the sample have completed 12-16 years of education, roughly equivalent to middle school and a high school diploma. Across almost every education level, more individuals selected "pretty happy" than "very happy" or "not too happy," possibly influenced by a tendency to prioritize these responses in general.  
  
  The second plot analyzes the distribution of observations for males and females separately, considering their overall happiness. Overall, participants tend to choose "pretty happy" more frequently than "very happy" or "not too happy," and there are more female participants in the dataset than male.   

  The third plot examines the distribution of observations across different work force statuses, factoring in gender and overall happiness. Most participants in the dataset are employed full-time, with only a small proportion in school, temporarily unemployed, or not working. More female participants are homemakers or work part-time compared to male participants, while gender distribution is relatively even across other work force statuses. The overall pattern of happiness preference remains consistent across genders.   
  
  The fourth plot illustrates the distribution of observations across different household income levels, considering overall happiness. The majority of participants have a household income above $10,000, especially those with incomes exceeding $25,000, who strongly favor "pretty happy" and "very happy" over "not too happy." The general pattern of happiness preference persists across all income levels.    

  The fifth plot displays the distribution of observations for participants with different numbers of young household members, adjusting for overall happiness. Most participants do not have anyone under 17 in their household, while those who do typically have one or two such members. The overall pattern of happiness preference remains consistent across these groups.

  Finally, we decided on predicting whether people with higher socioeconomic status are happier with these predictors: work force status (“workstat”), total family income (“income”), highest year of school completed (“educ”), gender (“female”), and the number of household members under 17 (“young_members”).


## Methodology: Interaction Assessment and Model Selection

  Among our predictors, we examined two possible interactions: the interaction between work force status and gender, and that between household income and the count of household members under 17. Given the societal expectation for women to bear children and the stereotype of women primarily responsible for childcare, we anticipate a stronger correlation between being female and working part-time. Additionally, we anticipate that households with higher incomes will generally be able to support more members under 17, necessitating greater economic assistance from other family members.

```{r, echo = F, results = F}

m0 <- lm(Happy ~ as.factor(workstat) + educ + young_members + as.factor(income) + 
           female,
         data = Happiness)

m1 <- lm(Happy ~ as.factor(workstat) + educ + young_members + as.factor(income) + 
           female + as.factor(workstat)*female,
         data = Happiness)

anova(m0, m1)

```
Through an anova-f fest, we conducted a comparison between the original model and an interaction model (involving both work force status and gender) to evaluate whether the interaction term, on average, performs better than alternatives, as opposed to the null hypothesis suggesting no interaction between work status and gender. This analysis aims to identify discrepancies resulting from the interaction term between the initial additive model and the interaction model. A significant F-test for the interaction term(s) signifies that the model incorporating interaction effects offers a more suitable representation of the data compared to the model lacking interaction effects.
 
F test: 
(all coef associated with the interaction term are equal to 0).   
H0: there is no interaction between working status and whether one is woman.   
Ha: there is an interaction between working status and whether one is woman.   

The p-value for the interaction term involving full-time work status and gender is 0.0003, indicating statistical significance as it falls below the conventional threshold of 0.05. This provides ample evidence to reject the null hypothesis. Consequently, we conclude that the association between happiness and full-time employment status varies based on the gender of the respondent.

```{r, echo = F, results = F}
#Interaction between years of education and working status

m2 <- lm(Happy ~ as.factor(workstat) + educ + young_members + as.factor(income) + 
           female + + as.factor(workstat)*female + as.factor(income)*young_members,
         data = Happiness)

anova(m1, m2)
```

We constructed a second model to assess additional interaction effects by incorporating another interaction term, this time between household income and the presence of young members, alongside the existing interaction model. Our findings revealed significant results for both F-tests. Specifically, the F-statistic value of 0.033 for the interaction term involving household income (measured in dollars per year) and the number of children (young_members) across all levels falls below the significance level of 0.05. This provides sufficient evidence to reject the null hypothesis. Consequently, we infer that the association between the general happiness score and household income (measured in dollars per year) is contingent upon the number of children within the household.

In our study, we contemplated employing both multinomial regression and ordinal regression models for the categorical response variable. Ultimately, we opted for the latter. The decision was straightforward, as the response variable "happy" exhibits an ordinal nature, with discernible gradations from "not too happy" to "pretty happy" to "very happy."

After assessing and confirming all the above conditions, we went into fitting the ordinal regression model.

## Results

```{r, echo = F, message = F, results = F, warning = F}

library(MASS)
m3 <- polr(as.factor(Happy) ~ workstat + educ + young_members + income + female + as.factor(workstat) * female + as.factor(income) * young_members, 
           data = Happiness, Hess = T)
exp(coef(m3))

```

```{r, echo = F}

library(knitr)
include_graphics("Exp Coef.png")

```

  Based on the outcomes derived from the regression model, we have formulated interpretations corresponding to each of the predictor variables.

workstat:  
According to the ordinal regression model, a person who retired is predicted to have 1.213 times the odds of being in the next higher score of happiness category compared to a person who keeps house, while adjusting for years of education, household income, the number of children they have, and whether being a woman. In the work force status categories, people with all other status are predicted to have lower possibilities of being in the next higher score of happiness category compared to those who keep houses, while adjusting for years of education, household income, the number of children in their household, and whether being a woman. 

educ:  
A person who has one more year of education is predicted to have 1.05 times the odds of being in the next higher score of happiness category compared to a person who has less years of education, while adjusting for work force status, household income, the number of children in their household, and whether being a woman.

young_members:  
A person who has one more number of children in their household is predicted to have 1.021 times the odds of being in the next higher score of happiness category compared to a person who has less numbers of children in their household, while adjusting for work force status, household income, years of education, and whether being a woman.

female:  
A person who is a woman is predicted to have 1.007 times the odds of being in the next higher score of happiness category compared to a person who is a man, while adjusting for years of education, household income, and number of children in their household. 

income:  
According to the ordinal regression model, a person in a household with $25000+ total income is predicted to have 2.709 times the odds of being in the next higher score of happiness category compared to a person in a household with $1000-2999 total income, while adjusting for years of education, work force status, the number of children they have, and whether being a woman. In the total family income categories, people with all other status are predicted to have lower possibilities of being in the next higher score of happiness category compared to those with $1000-2999 total income, which is the lowest of all, while adjusting for other variables.

## Discussion

  In summary, the overarching conclusion is that employed females with higher household incomes, advanced educational attainment, and a greater number of children at home tend to report higher levels of happiness. However, two unexpected findings emerged: firstly, that females exhibit greater happiness compared to males, contrary to the assumption that males typically possess higher socioeconomic status and thus should be happier. This discrepancy may be attributed to societal and economic pressures placed on males, who are traditionally viewed as primarily responsible for household financial well-being. Secondly, the positive correlation between the presence of young household members and happiness may be explained by the emotional support and warmth provided by children to adults.

  Some limitations in this research include: the potentially problematic strategy on dropping the N/A data (as some missing data may be due to lower SES status), the sampling bias caused by self-reported happiness, and potential missing interactions. In addition to addressing the limitations in our research, future studies in this field can concentrate on investigating the underlying reasons behind the two unexpected findings, evaluating the validity of the explanations we have proposed, and exploring additional factors that may influence the relationship between socioeconomic status and happiness.

